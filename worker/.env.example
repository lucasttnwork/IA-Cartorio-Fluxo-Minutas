# =============================================================================
# Minuta Canvas Worker - Environment Configuration
# =============================================================================
# Copy this file to .env and fill in your values
# =============================================================================

# -----------------------------------------------------------------------------
# Supabase Configuration (REQUIRED)
# -----------------------------------------------------------------------------
# Get these from your Supabase project settings: Settings > API
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key

# -----------------------------------------------------------------------------
# Google AI Configuration (REQUIRED)
# -----------------------------------------------------------------------------
# Get from Google AI Studio: https://aistudio.google.com/apikey
GOOGLE_AI_API_KEY=your-google-ai-api-key
# Alternative name (both work)
# GEMINI_API_KEY=your-gemini-api-key

# Model to use for AI processing (default: gemini-3-flash-preview)
# GOOGLE_AI_MODEL=gemini-3-flash-preview

# -----------------------------------------------------------------------------
# Google Document AI Configuration (REQUIRED for OCR)
# -----------------------------------------------------------------------------
# Create a processor at: https://console.cloud.google.com/ai/document-ai
GOOGLE_CLOUD_PROJECT_ID=your-gcp-project-id
GOOGLE_CLOUD_PROCESSOR_ID=your-document-ai-processor-id
GOOGLE_CLOUD_LOCATION=us

# Path to Google Cloud service account credentials JSON file
# GOOGLE_APPLICATION_CREDENTIALS=/path/to/service-account.json

# -----------------------------------------------------------------------------
# Worker Configuration
# -----------------------------------------------------------------------------

# Maximum concurrent jobs to process (default: 5)
# Increase for better throughput on powerful machines
# Recommended: 5-10 for single worker, 3-5 per worker in cluster
MAX_CONCURRENT_JOBS=10

# Job timeout in milliseconds (default: 300000 = 5 minutes)
# Jobs exceeding this timeout will be marked as failed
JOB_TIMEOUT=300000

# Zombie job threshold in milliseconds (default: 120000 = 2 minutes)
# Jobs stuck in 'processing' for longer than this will be auto-recovered
ZOMBIE_JOB_THRESHOLD_MS=120000

# Enable automatic zombie job recovery (default: true)
ENABLE_AUTO_RECOVERY=true

# Active polling interval in milliseconds (default: 5000 = 5 seconds)
# How often to check for new jobs when slots are available
ACTIVE_POLL_INTERVAL_MS=5000

# Legacy polling interval (fallback when Realtime is unavailable)
POLL_INTERVAL=5000

# Retry configuration for failed jobs
RETRY_BASE_DELAY=10000
RETRY_MAX_DELAY=300000

# Health check server port (default: 3001)
WORKER_HEALTH_PORT=3001

# -----------------------------------------------------------------------------
# Feature Flags
# -----------------------------------------------------------------------------

# Enable debug logging (default: true in development)
# DEBUG=true

# Enable metrics collection (default: false)
# ENABLE_METRICS=false

# -----------------------------------------------------------------------------
# Application
# -----------------------------------------------------------------------------

# Environment: development, production, test
NODE_ENV=development

# Application name (for logging)
APP_NAME=Minuta Canvas Worker
